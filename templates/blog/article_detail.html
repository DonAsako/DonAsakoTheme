{% extends 'base.html' %}
{% load i18n static %}
{% block title %} - {{ article.get_translation.title }}{% endblock %}
{% block head %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex.min.css" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex.min.js" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/contrib/auto-render.min.js" crossorigin="anonymous"></script>
{% with markdown_css=ACTIVE_THEME|add:"/css/markdown.css" %}
<link rel="stylesheet" href="{% static markdown_css %}">
{% endwith %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/github.min.css" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js" crossorigin="anonymous"></script>
{% endblock %}

{% block og_type %}
    <meta property="og:type" content="article">
{% endblock %}
{% block og_title %}
    <meta property="og:title" content="{{ article.get_translation.title }}">
{% endblock %}
{% block og_description %}
    <meta property="og:description" content="{{ article.get_translation.description }}">
{% endblock %}
{% block og_url %}
    <meta property="og:url" content="{{ request.build_absolute_uri }}">
{% endblock %}

{% block og_image %}
    {% if article.picture %}
    <meta property="og:image" content="{{ article.picture.url }}">
    {% endif %}
{% endblock %}

{% block meta_properties %}
<meta property="article:published_time" content="{{ article.published_on.isoformat }}">
<meta property="article:modified_time" content="{{ article.edited_on.isoformat }}">
{% for tag in article.tags.all %}<meta property="article:tag" content="{{ tag.title }}">{% endfor %}
{% endblock %}

{% block content %}
<div class="article--container">
    <div class="article--wrapper">
        <div class="article-header">
            <h1>{{ article.get_translation.title }}</h1>
            {% if article.get_translation.description %}
            <p>{{ article.get_translation.description }}</p>
            {% endif %}
            <div class="article-header-meta">
                <div class="article-meta-item">
                    <strong>{% trans 'Published' %}:</strong>
                    <span>{{ article.published_on|date:"Y-m-d" }}</span>
                </div>
                {% if article.edited_on != article.published_on %}
                <div class="article-meta-item">
                    <strong>{% trans 'Updated' %}:</strong>
                    <span>{{ article.edited_on|date:"Y-m-d" }}</span>
                </div>
                {% endif %}
                {% if article.category %}
                <div class="article-meta-item">
                    <strong>{% trans 'Category' %}:</strong>
                    <span class="article-meta-badge">{{ article.category }}</span>
                </div>
                {% endif %}
            </div>
            {% if article.tags.all %}
            <div class="article-tags">
                {% for tag in article.tags.all %}
                <span class="article-tag">{{ tag.title }}</span>
                {% endfor %}
            </div>
            {% endif %}
        </div>
        {% if article.picture %}
        <div class="article--picture-wrapper">
            <img src="{{ article.picture.url }}" alt="{{ article.get_translation.title }}">
        </div>
        {% endif %}
        <div class="article--content markdown-body">
            {{ article.get_translation.get_content_as_html }}
        </div>
    </div>
    {% include 'components/toc.html' %}
</div>
{% endblock %}
{% block scripts %}
<script>
hljs.highlightAll();
document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
        delimiters: [
            {left: "\\[", right: "\\]", display: true},
            {left: "$$", right: "$$", display: true},
            {left: "$", right: "$", display: false},
            {left: "\\(", right: "\\)", display: false}
        ]
    });
});
</script>
{% endblock %}
